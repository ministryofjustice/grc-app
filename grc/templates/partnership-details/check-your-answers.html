{% extends 'base.html' %}

{% block backLink %}
    <a href="{{ url_for('taskList.index') }}" class="govuk-back-link">Back</a>
{% endblock %}

{% macro summaryListItem(title, changeLinkHiddenText, changeLinkUrl, value) %}
    <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
            {{ title }}
        </dt>
        <dd class="govuk-summary-list__value">
            {{ value }}
        </dd>
        <dd class="govuk-summary-list__actions">
            <a href="{{ changeLinkUrl }}" class="govuk-link">
                Change
                <span class="govuk-visually-hidden">
                    {{ changeLinkHiddenText }}
                </span>
            </a>
        </dd>
    </div>
{% endmacro %}

{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            <h1 class="govuk-heading-l">
                <span class="govuk-caption-l">Check your answers:</span>
                Marriage or civil partnership details
            </h1>

            <dl class="govuk-summary-list govuk-!-margin-bottom-9">
                {{ summaryListItem(
                    title='Currently married or in a civil partnership',
                    changeLinkHiddenText='if you are currently married or in a civil partnership',
                    changeLinkUrl=url_for('partnershipDetails.index'),
                    value=(session['application']['partnershipDetails']['marriageCivilPartnership'])
                ) }}

                {% if session['application']['partnershipDetails']['marriageCivilPartnership'] == 'Neither' %}
                    {{ summaryListItem(
                        title='Spouse or partner has died',
                        changeLinkHiddenText='if your spouse or partner has died',
                        changeLinkUrl=url_for('partnershipDetails.partnerDied'),
                        value=(session['application']['partnershipDetails']['partnerDied'])
                    ) }}

                    {{ summaryListItem(
                        title='Marriage or civil partnership has ended',
                        changeLinkHiddenText='if your marriage or civil partnership has ended',
                        changeLinkUrl=url_for('partnershipDetails.endedCheck'),
                        value=(session['application']['partnershipDetails']['endedCheck'])
                    ) }}

                {% else %}
                    {{ summaryListItem(
                        title='Remain married',
                        changeLinkHiddenText='if you plan to remain married after receiving your Gender Recognition Certificate',
                        changeLinkUrl=url_for('partnershipDetails.stayTogether'),
                        value=(session['application']['partnershipDetails']['stayTogether'])
                    ) }}

                    {% if session['application']['partnershipDetails']['stayTogether'] == 'Yes' %}
                        {{ summaryListItem(
                            title='Can provide a declaration of consent from your spouse',
                            changeLinkHiddenText='if you can provide a declaration of consent from your spouse',
                            changeLinkUrl=url_for('partnershipDetails.partnerAgrees'),
                            value=(session['application']['partnershipDetails']['partnerAgrees'])
                        ) }}
                    {% endif %}

                    {% if session['application']['partnershipDetails']['stayTogether'] == 'No' or session['application']['partnershipDetails']['partnerAgrees'] == 'No' %}
                        {{ summaryListItem(
                            title='Interim GRC',
                            changeLinkHiddenText='if you understand that you will receive an Interim GRC',
                            changeLinkUrl=url_for('partnershipDetails.interimCheck'),
                            value=(session['application']['partnershipDetails']['interimCheck'])
                        ) }}
                    {% endif %}
                {% endif %}
            </dl>

            <form method="POST" action="{{ url_for('partnershipDetails.checkYourAnswers') }}">
                {{ form.csrf_token }}

                <div class="govuk-button-group">
                    <button class="govuk-button" data-module="govuk-button">
                        Save and continue
                    </button>
                    <a href="{{ url_for('taskList.index') }}" class="govuk-link govuk-link--no-visited-state">
                        Return to task list
                    </a>
                </div>
            </form>

        </div>
    </div>
{% endblock %}
